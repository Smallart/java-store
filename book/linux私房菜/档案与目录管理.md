# 档案与目录管理

linux中一些特殊的目录

```cmd
. 代表此层目录
.. 代表上一层目录
- 代表前一个工作目录
~ 代表 目前使用者身份，所在的家目录
~ account 代表account这个使用者的家目录（account是个账号名称）
```

一个特殊的点要注意一下，在linux下，根目录下有没有上层目录[..]，其实是有的，但是这代表根目录的上一层(..)与根目录自己（.）是同一个目录。

几个常用的处理目录的指令：`cd(变换目标) pwd(显示目前的目录) mkdir(建立一个新的目标) rmdir(删除一个空的目标)`

```shell
# 表示到xxx这个使用者的家目录/home/dmtsai
cd ~xxx
# 回到自己的家目录
cd
# 回到上层目录
cd -

# 单纯显示当前的工作目录
pwd

# 列出当前的连接档
pwd -P

# 建立新目录
mkdir
# 参数p 将这个路径上的所需文件夹全部建立起来，不使用参数则需要一层层的创建
mkdir -p test/test1/test2
# 设定目录权限
mkdir -m 
# 连通上层的文件夹一起删除，仅能删除空的文件夹
rmdir -p
```
## 档案与目录管理

档案和目录的管理，不外乎显示属性、拷贝、删除档案以及移动档案或目录。相关命令`ls cp rm mv`

```shell
# 其中要注意参数 a i p（连同档案的属性[权限、用户、时间]一起复制过去，而非使用预设属性 备份常用） 默认会改变当前文档属性
cp 来源档 目标档
# 将文件复制到当前目录 .
cp /var/log/wtmp .
# -a 表示将这个档案的所有属性复制过去，

# -r 递归复制，复制文件夹，但是相关属性可能会发生改变

# 将多个资料一次性复制到同一个目录去！最后是一个目标目录
cp ~/.bashrc ~/.bash_history .tmp


# -f 强制删除 -i 删除前询问 -r 迭代删除
rm [-fir]

# -f 强制，有则覆盖 -u 目标有，且source新才会更新
mv [-fiu] source destination

# 结果 network
basename /etc/sysconfig/network
# 文件夹 /etc/sysconfig
dirname /etc/sysconfig/network
```

使用cp命令时要注意：是否需要完整的保留来源档案的资讯？来源档案是否为连接档？来源档是否为特殊的档？来源档是否为目录？

## 档案内容查询

```shell

cat 从第一行开始显示档案内容
tac 从最后一行开始显示内容
nl 显示时候，显示行号
more 一页一页的显示档案内容
less 与more类似，但是比more好，可以往前翻页
head 只看头几行
tail 只看尾几行
od 以二进制读取档案内容

```

* touch 修改档案时间和新建档案

每个档案在linux低下会记录很多的时间参数，其中有三个主要的变更时间：
* modificaiton time mtime 当该档案内容变更时，就会更新这个时间
* status time ctime 当档案权限与属性更改了，就会更新这个时间
* access timee atime 当档案内容被读取了，比如使用cat去读取

```shell
# 若档案不存在 则创建一个新的
touch [-acdmt] 档案
-a 修改access time
-c 仅改变档案的时间，若档案不存在则不建立新档案

```

要注意的时，即使我们复制一个档案，复制所有的属性，但也灭有办法复制ctime这个属性的。ctime可以记录这个档案的最近的状态被改变的时间。

## 档案的预设权限和隐藏权限

如何知道创建一个新的文档时，系统给的预设权限？

```shell

umaskd
# 最后三个数字与权限有关，第一位是特殊权限使用
0022 
umask -S
u=rwx,g=rx,o=rx
#重新设定默认的权限
umask 

```

要注意的是，umask表示的是该预设值需要减掉的权限。也就是说当前文档没有写的权限则值为2

当你想要知道某个档案的基本资料，是属于ASCII或是data档案，或是binnary，可以使用file这个指令来检阅。透过这个指令，我们可以简单的判断这个档案的格式。

##指令与档案的收索

通过which/type指令可以查询指令的完整档名。which这个指令是根据PATH这个环境变量所规范的路径，去搜索执行档的档名。

档案档名的搜索。这也有几个指令，其中find不常用，应为速度慢，一般使用whereis或是locate来检查，如果真的查不到了，才以find来搜素，因为whereis只找到系统中某些特定目录下的档案而已，locate则是利用资料库来搜索档名。

whereis 指令快就快在只寻找几个特定的目录，也就是说whereis主要针对/bin/sbin低下的执行档，以及/usr/share/man底下的man page档案，以及另外几个比较特定的目录来处理。

locate 后面输入档案的部分名称，则只要在完整档案名当中包含passwd的都会被显示。但是这个指令只会查找已建立的资料库 /var/lib/mlocate里面的资料。当个这个资料库默认是每天执行一次，当然可以手动更新`updatedb`。

* find
```shell

find [PATH] [option] [action]

1. 与时间有关
-mtime n n为数字，意味着在n天之前的一天内被更改过内容的档案
-mtime +n 列出在n天之前被改动过内容的档案名称
-mtime -n 列出在n天之内含n天本身被更动过内容的档案名
-newer file file为一个存在的档案，理出比file还要新的档案名

# 0代表当前的时间，从现在开始到24小时前，有变动过内容的档案都会被列出来，
find / -mtime 0

# 寻找/etc底下的档案，如果档案日期比/etc/passwd新就列出
find /etc -newer /etc/passwd
```

如果要查找的档案具有特殊属性的，例如SUID、档案拥有者、档案大小等等，利用locate是没有办法达成这样的搜索，但是find就可以，find还可以利用*号来模糊搜索，唯一的缺点便是该操作直接读取硬盘，比较慢与耗资源。

