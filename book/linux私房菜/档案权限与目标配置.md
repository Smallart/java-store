# 档案权限与目录配置

Linux的一大特点便是可以多人多工作环境，所以为了让各个使用者具有各自的保密档案资料，故就需要对每个档案进行权限管理。Linux一般将档案可取的身份分为三个类别，分别为 owner/group/others,且三种身份各有 read/write/execute等权限。

在Linux系统中，预设的情况下，所有系统上的账号与一般身份使用者，还有root的相关信息都是在`/etc/passwd`这个档案内的。但是个人的密码则是记录在`/etc/shadow`档案下，此外，linux所有的群组名称都记录在`/ect/group`内。这三个档案是Linux系统里账号、密码、群组的集中地。

```shell
# 文件属性
-rw-r--r--[权限] 1[连接数] root[拥有者] root[群组] 1864[容量] May 4 18:01[修改时间] config[文件名]

```

* 文件权限类型

![档案类型](/img/user_auth.png)

* 第一个字元代表这个档案的类型：目录、文件或是连接档
    * 当为[d]则是目录
    * 当为[-]则是文件
    * 若为[l]则表示为链接档
    * 若为[b]表示为装置档里面的可供存储的周边设置
    * [C]表示装置档里的设备：如键盘或是鼠标
* 接下来的字母中，以三个为一组，均为[rwx]的三个参数组合，其中[r]表示可读，[w]表示可写，[x]表示可执行。这三个权限位置不会改变，如果没有权限，则会出现[-]
    * 第一组为档案拥有者所拥有的权限
    * 第二组为群组权限
    * 第三组为其他账号权限

* 连接数
每个档案都会将他的权限与属性记录到档案系统的i-node中，不过，我们使用目录树确使用档名来记录，因此每个档名就会连结到一个i-node中。这个属性记录的，就是有多个不同的档名连接到相同的一个i-node号码去了。

# 改变档案属性与权限

* chgrp：改变档案所属群组
* chown：改变档案拥有者
* chmod：改变档案权限，SUID，SGID，SBIT等等

`chgrp`这个命令用来改变一个档案的群组，但是被改变的群组名称必须在`/etc/group`档案内存在才行，否则会显示错误。
`chown`改变使用者，要注意的是使用者必须是已经存在系统的账号，也就是在`/etc/passwd`这个档案中有记录的使用者名称
`chmod`权限修改，可以使用数字或是符号来进行权限的变更

如果一个文件权限字母为 `-rwxrw-r--`,其中按照数字来代表各个权限，其中对照关系如下：`r:4 w:2 x:1`。每种身份（owner/group/other）各自的三个权限分数需要累加，所以要设置的话就变为了`chmod 764 xxx`。
当然也可以使用字母的方式设定：`chmod u=rwx,g=rw,o=r`。并且`+表示加入、-表示除去 =表示设定 a表示全部 u user g group o other`

权限对于目录：
* r 表示具有读取目录结构清单的权限，表示你可以查询该目录下的档名资料。也就是可以使用ls这个指令将目录中的内容列表显示出来
* w 表示你具有移动这个目录结构的权限
    * 建立新的档案与目录
    * 删除存在的档案与目录
    * 将已存在的档案和目录进行改名
    * 搬移目录内的档案、目录位置
* x 表示使用者能否进入该目录成为工作目录，也就是 指令 cd能否进入到该目录中

连接档，类似于Windowsi系统下的快捷方式。

Linux中一些默认的文件夹
* /（根）：根目录是整个系统最重要的一个目录，因为不但所有的目录都是由根目录衍生而来，同时根目录也与开机/还原/系统修复等动作有关。根目录所在分割应该越小越好，且应用程序所安装的软件不要与目录放在一个分隔槽中，保持根目录越小越好。

根据上面的约束，Linux定义了根目录下应该要有底下这些次级目录：
* /bin 该目录放置的是在单人维护模式下还能被操作的指令。
* /boot 主要放置开机会使用到的档案，包括linux核心档案以及开机所需设定档
* /dev 任何外设
* /etc 系统主要的设定档几乎都放置到这个目录下。并且这个目录的各个档案属性都是让一般使用者查阅的，但是只有root有权利修改。
    * /etc/opt 放置第三方软件的相关设定档
* /lib 放置在开机时会用到的函数数，以及在/bin /sbin底下的指令会呼叫的函数库
* /media 放置的可移除装置，如光碟 DVD
* /mnt 暂时挂载某些额外的设备，U盘
* /opt 给第三方软件放置的目录
* /run 开机的产生的信息放置到这个地方 日志文件?
* /sbin 开机过程中所需要的各个指令
* /srv 一些网络服务启动之后，这些服务所需取用的资料目录
* /tmp 让一般使用者或是正在执行的程序展示放置档案的地方，该目录任何人都可以存区
* /usr 放置的资料属于可分享的与不可变的，所以可以通过网路进行分隔槽挂载，分享给其他当主机来用
* /var 放置变动性资料，系统运作时才会渐渐占用硬盘容量的目录，包括某些软件运作产生的档案。
* /home 系统预设的使用者加目录（home directory）
    * ~：代表目前这个使用者的家
* /root root的家目录

/usr 的全称为`Unix Software Resource`的缩写，也就是软件开发者应该将他们的资料合理的分别放置到这个目录下的次目录，而不要自行建立软件自己独立的目录。类似于windows 下`C:\Windows\ + C:\Program files\`这两目录的综合体。
* /usr/bin 所有一般用户可以使用的指令
* /usr/lib 基本上于/lib功能相同
* /usr/local 系统管理员在本机自行安装自己下载的软件，
* /usr/sbin 非系统正常运作所需的系统指令
* /usr/share 主要放置只读架构的资料档案，当然也包括共享文件
* /user/src/ 相关源码文件放置


## 目录树

在linux下，所有的档案与目录都是由根目录开始的，我们将这些目录称之为目录树，他有如下特点：
* 目录树的起始点为根目录
* 每个目录不只使用本地端的partition的档案系统，也可以使用网络上的filessystem。
* 每个档案在此目录书中的档名都是独一无二的